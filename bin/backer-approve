#! /usr/bin/env bash

message() {
    echo
    echo ----------------------------------------------
    echo "$@"
    echo ----------------------------------------------
    echo
}

#!/usr/bin/env bash
set -ex

BIN_DIR=${BIN_DIR:-$(cd "${0%/*}"&&pwd)}
DEPLOY_DIR=deployments/$(seth chain)
ADDRESS_DIR=$PWD/$DEPLOY_DIR
ADDRESS_FILE="$ADDRESS_DIR/addresses.json"





message Contracts

CURRENCY=$(cat $ADDRESS_FILE | jq  -r '.CURRENCY')
COLLATERAL=$(cat $ADDRESS_FILE | jq  -r '.COLLATERAL')
LENDER=$(cat $ADDRESS_FILE | jq  -r '.LENDER')
echo "Currency: $CURRENCY"
echo "Collateral: $COLLATERAL"
echo "Lender: $LENDER"


message Approve

# backer allows lender to take currency
seth send $CURRENCY 'approve(address,uint)' $LENDER ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff --keystore=$BACKER_ETH_KEYSTORE --password=$BACKER_ETH_PASSWORD --from=$BACKER_ETH_FROM

# backer allows lender to take collateral
seth send $COLLATERAL 'approve(address,uint)' $LENDER ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff --keystore=$BACKER_ETH_KEYSTORE --password=$BACKER_ETH_PASSWORD --from=$BACKER_ETH_FROM